pipeline {
    agent any
    tools{
        nodejs '22.3.0'
    }
    stages{
        stage("charts Clone"){
            steps{
                script{
                    sh "rm -rf ./charts"
                    sh "git clone https://github.com/Harsha190202/charts.git -b ${env.ChartsBranch}"
    
                }
            }
        }
        stage("Front-end clone") {
            steps{
                script{
                    sh "rm -rf ./mocktest-frontend"
                    sh "git clone https://github.com/Harsha190202/mocktest-frontend.git -b ${env.FrontendBranch}"
                }
            }
        }

        stage("frontend-dependencies"){
            steps{
                dir("./mocktest-frontend/"){
                    script{
                        sh "rm -rf node_modules"
                        sh "npm cache clean --force"
                        sh "npm install"
                    }
                }
            }
        }
        stage("front-end-build"){
            steps {
                dir("./mocktest-frontend/"){
                    script{
                        sh "npm run build "
                    }
                }
            }
        }

        stage("Docker Build") {
            steps {
                script{
                    sh "sudo docker build -f applications/mocktest-frontend/Dockerfile -t mocktest-frontend ." 
                    sh "sudo docker tag mocktest-frontend:latest harsha3330/mocktest-frontend:${env.FrontendBranch}-${BUILD_NUMBER}-date-${BUILD_TIMESTAMP}-dev"
                    sh "sudo docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD""
                    sh "sudo docker push harsha3330/mocktest-frontend:${env.FrontendBranch}-${BUILD_NUMBER}-date-${BUILD_TIMESTAMP}-dev"
                    sh "sudo docker rmi harsha3330/mocktest-frontend:${env.FrontendBranch}-${BUILD_NUMBER}-date-${BUILD_TIMESTAMP}-dev"
                }
            }
        }

        
        stage("Deployment") {
            steps {
                dir("/CHARTS/") {
                    script{
                        sh "sed command"
                    }
                }
            }
        }
        
    }

}


